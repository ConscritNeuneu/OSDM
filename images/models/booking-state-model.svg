<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="688px" preserveAspectRatio="none" style="width:1173px;height:688px;" version="1.1" viewBox="0 0 1173 688" width="1173px" zoomAndPan="magnify"><defs><filter height="300%" id="f13vkr5l86d3dm" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="401.32" cy="16" fill="#000000" filter="url(#f13vkr5l86d3dm)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><g id="prebooked"><rect fill="#FEFECE" filter="url(#f13vkr5l86d3dm)" height="50" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="96" x="353.32" y="103"/><line style="stroke:#A80036;stroke-width:1.5;" x1="353.32" x2="449.32" y1="129.2969" y2="129.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="363.32" y="120.9951">prebooked</text></g><g id="confirmed"><rect fill="#FEFECE" filter="url(#f13vkr5l86d3dm)" height="50" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="89" x="627.82" y="245"/><line style="stroke:#A80036;stroke-width:1.5;" x1="627.82" x2="716.82" y1="271.2969" y2="271.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="637.82" y="262.9951">confirmed</text></g><g id="cancelled"><rect fill="#FEFECE" filter="url(#f13vkr5l86d3dm)" height="50" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="86" x="176.32" y="245"/><line style="stroke:#A80036;stroke-width:1.5;" x1="176.32" x2="262.32" y1="271.2969" y2="271.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="186.32" y="262.9951">cancelled</text></g><g id="error"><rect fill="#FEFECE" filter="url(#f13vkr5l86d3dm)" height="50" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="53" x="432.82" y="387"/><line style="stroke:#A80036;stroke-width:1.5;" x1="432.82" x2="485.82" y1="413.2969" y2="413.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="442.82" y="404.9951">error</text></g><g id="fulfilled"><rect fill="#FEFECE" filter="url(#f13vkr5l86d3dm)" height="50" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="67" x="936.82" y="387"/><line style="stroke:#A80036;stroke-width:1.5;" x1="936.82" x2="1003.82" y1="413.2969" y2="413.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="946.82" y="404.9951">fulfilled</text></g><ellipse cx="578.32" cy="666" fill="none" filter="url(#f13vkr5l86d3dm)" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="578.82" cy="666.5" fill="#000000" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><g id="refunded"><rect fill="#FEFECE" filter="url(#f13vkr5l86d3dm)" height="50" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="83" x="655.82" y="529"/><line style="stroke:#A80036;stroke-width:1.5;" x1="655.82" x2="738.82" y1="555.2969" y2="555.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="665.82" y="546.9951">refunded</text></g><!--MD5=[0d41cb91972f753efa07e36ffb227bf7]
link *start to prebooked--><path d="M401.32,26 C401.32,41.46 401.32,73.68 401.32,97.6 " fill="none" id="*start-to-prebooked" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="401.32,102.87,405.32,93.87,401.32,97.87,397.32,93.87,401.32,102.87" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="424" x="402.32" y="69.0669">POST /Bookings with OfferIds, Optional AccoIds, Optional ancillaries</text><!--MD5=[4f6bdfb1533e6d9d808589b5af9028c7]
link prebooked to confirmed--><path d="M447.91,153.07 C496.73,178.29 573.11,217.75 622.95,243.5 " fill="none" id="prebooked-to-confirmed" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="627.69,245.94,621.5364,238.2502,623.2497,243.6413,617.8586,245.3546,627.69,245.94" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="592.32" y="196.0669">POST /Bookings/id/fulfillments</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="565.32" y="211.1997">where at least 1 fulfillment is confirmed</text><!--MD5=[73679c7aae83feaf865b8c4180e29b54]
link prebooked to cancelled--><path d="M353.03,128.91 C265.13,129.87 84.44,137.49 45.32,183 C6,228.73 106.7,252.55 170.86,262.75 " fill="none" id="prebooked-to-cancelled" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="176.18,263.58,167.9045,258.24,171.2398,262.809,166.6708,266.1443,176.18,263.58" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="46.32" y="203.5669">DELETE /Bookings/id</text><!--MD5=[73679c7aae83feaf865b8c4180e29b54]
link prebooked to cancelled--><path d="M353.19,136.41 C304.07,145.06 232.78,161.05 216.32,183 C204.36,198.95 205.68,221.64 209.69,239.71 " fill="none" id="prebooked-to-cancelled-1" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="210.89,244.68,212.6954,234.998,209.7313,239.8161,204.9132,236.852,210.89,244.68" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="217.32" y="203.5669">ticket-time-limit reached</text><!--MD5=[7e5f2e0e0de630f102e3d00adcfff96f]
link prebooked to error--><path d="M403.57,153.32 C407.84,195.39 418.51,284.26 438.32,357 C440.57,365.28 443.66,374.04 446.77,382.03 " fill="none" id="prebooked-to-error" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="448.7,386.9,449.0975,377.0592,446.8554,382.2527,441.6618,380.0106,448.7,386.9" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="440.82" y="267.0669">unrecoverable error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="424.32" y="282.1997">at confirmation/fulfillment</text><!--MD5=[bdb020530c54befa3afbb492ec957f51]
link prebooked to fulfilled--><path d="M449.34,131.37 C545.66,136.73 758.81,151.82 824.32,183 C906.92,222.31 937.3,240.91 973.32,325 C980.89,342.67 980.09,364.31 977.42,381.46 " fill="none" id="prebooked-to-fulfilled" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="976.54,386.63,981.9999,378.4331,977.3828,381.7015,974.1143,377.0845,976.54,386.63" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="966.32" y="267.0669">POST /Bookings/id/fulfillments</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="963.32" y="282.1997">where all fulfillments are fulfilled</text><!--MD5=[7f1eec40899c46beac3a724dc226dbac]
link cancelled to *end--><path d="M226.1,295.05 C239.57,339.45 273.24,435.56 328.32,499 C400.38,582 523.46,640.94 564.53,659.1 " fill="none" id="cancelled-to-*end" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="569.34,661.21,562.7086,653.9282,564.7622,659.1992,559.4912,661.2528,569.34,661.21" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="329.32" y="487.5669">grace period expired</text><!--MD5=[e160308e1413fe67be64b131e06ddaec]
link confirmed to fulfilled--><path d="M691.97,295.28 C710.73,317.84 738.16,349.1 752.32,357 C812.07,390.33 837.38,368.75 903.32,387 C912.65,389.58 922.54,392.83 931.78,396.1 " fill="none" id="confirmed-to-fulfilled" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="936.55,397.8,929.4223,391.0033,931.8419,396.1165,926.7287,398.5362,936.55,397.8" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="760.82" y="338.0669">PATCH /bookings/id/fulfillments</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="757.32" y="353.1997">&lt;all fulfillments are now fulfilled&gt;</text><!--MD5=[3e5562a8b963700f58278750a0fef680]
link confirmed to refunded--><path d="M674.45,295.04 C679.01,346.53 689.72,467.3 694.69,523.39 " fill="none" id="confirmed-to-refunded" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="695.16,528.62,698.348,519.3014,694.7176,523.6396,690.3794,520.0092,695.16,528.62" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="687.32" y="409.0669">patch /bookings/id/refundOffer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="702.32" y="424.1997">&lt;all fulfillments refunded&gt;</text><!--MD5=[1db40179f6a4d84b7f8f62d8a21617cb]
link confirmed to error--><path d="M627.74,281.97 C564.69,297.5 456.99,324.14 456.32,325 C443.97,340.82 445.41,363.73 449.56,381.92 " fill="none" id="confirmed-to-error" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="450.8,386.92,452.5246,377.2233,449.6008,382.0659,444.7581,379.1421,450.8,386.92" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="209" x="457.32" y="338.0669">unrecoverable error at fulfillment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="481.82" y="353.1997">&lt;of a confirmed booking&gt;</text><!--MD5=[0737000096fd52729fbd803294fc4b01]
link fulfilled to refunded--><path d="M936.55,426.2 C926.01,430.02 914.27,433.97 903.32,437 C837.38,455.25 808.83,428.42 752.32,467 C732.08,480.82 717.66,504.8 708.67,523.93 " fill="none" id="fulfilled-to-refunded" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="706.51,528.69,713.8834,522.1606,708.5844,524.1406,706.6044,518.8416,706.51,528.69" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="753.32" y="480.0669">patch /bookings/id/refundOffer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="766.32" y="495.1997">&lt;all fulfillments refunded&gt;</text><!--MD5=[f393ce116f66033d46d211367829c82e]
link fulfilled to *end--><path d="M971.35,437.16 C970.94,455.77 967.6,481.25 954.32,499 C860.52,624.36 651.29,656.78 593.41,663.48 " fill="none" id="fulfilled-to-*end" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="588.29,664.05,597.671,667.0494,593.2605,663.5072,596.8026,659.0967,588.29,664.05" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="926.32" y="558.5669">archiving</text><!--MD5=[7e2463ff6bf1666df9b32fed669e6427]
link refunded to *end--><path d="M671.2,579.14 C645.51,602.89 607.53,638 589.11,655.02 " fill="none" id="refunded-to-*end" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="585.28,658.56,594.6079,655.3992,588.9557,655.1704,589.1845,649.5182,585.28,658.56" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="638.32" y="622.0669">archiving</text><!--MD5=[68785ad7221959f2878ebc71627aad27]
link error to *end--><path d="M463.13,437.25 C469.07,470.66 482.53,532.04 507.32,579 C523.65,609.94 552.3,640.04 567.74,655.08 " fill="none" id="error-to-*end" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="571.37,658.57,567.6499,649.4507,567.7639,655.1065,562.1082,655.2205,571.37,658.57" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="517.82" y="551.0669">DELETE /booking</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="508.32" y="566.1997">in a cleanup context</text><!--MD5=[dfb0b487950c3db402f0f6383564ce2d]
@startuml
[*] - -> prebooked : POST /Bookings with OfferIds, Optional AccoIds, Optional ancillaries

prebooked - -> confirmed: POST /Bookings/id/fulfillments \n where at least 1 fulfillment is confirmed
prebooked - -> cancelled: DELETE /Bookings/id
prebooked - -> cancelled: ticket-time-limit reached
prebooked - -> error: unrecoverable error \nat confirmation/fulfillment
prebooked - -> fulfilled: POST /Bookings/id/fulfillments \n where all fulfillments are fulfilled
cancelled - -> [*]: grace period expired
confirmed - -> fulfilled: PATCH /bookings/id/fulfillments \n <all fulfillments are now fulfilled>
confirmed - -> refunded: patch /bookings/id/refundOffer \n <all fulfillments refunded>
confirmed - -> error: unrecoverable error at fulfillment \n <of a confirmed booking>
fulfilled - -> refunded: patch /bookings/id/refundOffer \n<all fulfillments refunded>
fulfilled - -> [*] : archiving
refunded - -> [*] : archiving
error - -> [*] : DELETE /booking \nin a cleanup context
@enduml

PlantUML version 1.2020.22(Sun Dec 06 10:36:27 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>