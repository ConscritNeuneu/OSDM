<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1390px" preserveAspectRatio="none" style="width:1656px;height:1390px;" version="1.1" viewBox="0 0 1656 1390" width="1656px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ldm23e4a2han" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1ldm23e4a2han)" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="674" x="955" y="320.0938"/><rect fill="#FFFFFF" filter="url(#f1ldm23e4a2han)" height="406.7266" style="stroke:#000000;stroke-width:2.0;" width="1629" x="10" y="539.0234"/><rect fill="#FFFFFF" filter="url(#f1ldm23e4a2han)" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="674" x="955" y="776.9531"/><rect fill="#FFFFFF" filter="url(#f1ldm23e4a2han)" height="406.7266" style="stroke:#000000;stroke-width:2.0;" width="1629" x="10" y="959.75"/><rect fill="#FFFFFF" filter="url(#f1ldm23e4a2han)" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="674" x="955" y="1155.5469"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="73" x2="73" y1="88.2969" y2="1383.4766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1027" x2="1027" y1="88.2969" y2="1383.4766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1441" x2="1441" y1="88.2969" y2="1383.4766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1567" x2="1567" y1="88.2969" y2="1383.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="20" y="84.9951">API_Consumer</text><ellipse cx="73" cy="15" fill="#FEFECE" filter="url(#f1ldm23e4a2han)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M73,23 L73,50 M60,31 L86,31 M73,50 L60,65 M73,50 L86,65 " fill="none" filter="url(#f1ldm23e4a2han)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1ldm23e4a2han)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="120" x="965" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="972" y="72.9951">OSDM_Provider</text><rect fill="#FEFECE" filter="url(#f1ldm23e4a2han)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="124" x="1377" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="1384" y="72.9951">Journey_Planner</text><rect fill="#FEFECE" filter="url(#f1ldm23e4a2han)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="100" x="1515" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="1522" y="72.9951">FareProvider</text><rect fill="#EEEEEE" filter="url(#f1ldm23e4a2han)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1649" x="0" y="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1649" y1="118.8633" y2="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1649" y1="121.8633" y2="121.8633"/><rect fill="#EEEEEE" filter="url(#f1ldm23e4a2han)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="519" x="565" y="108.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="500" x="571" y="124.3638">Creating the trip collection &amp; getting the initial set of outward trips</text><polygon fill="#A80036" points="1015,158.5625,1025,162.5625,1015,166.5625,1019,162.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="73" x2="1021" y1="162.5625" y2="162.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="612" x="80" y="157.4966">POST /Trips-offers-collection &lt;MUNCHEN-PARIS, 23/10/2021, return 25/10/2021, 2 pax, dob, ...&gt;</text><polygon fill="#A80036" points="1429,187.6953,1439,191.6953,1429,195.6953,1433,191.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1435" y1="191.6953" y2="191.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="390" x="1034" y="186.6294">&lt;retrieve trips information based on API Consumer request&gt;</text><polygon fill="#A80036" points="1038,216.8281,1028,220.8281,1038,224.8281,1034,220.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1032" x2="1440" y1="220.8281" y2="220.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="1044" y="215.7622">&lt;trips information&gt;</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1069" y1="249.9609" y2="249.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1069" x2="1069" y1="249.9609" y2="262.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1028" x2="1069" y1="262.9609" y2="262.9609"/><polygon fill="#A80036" points="1038,258.9609,1028,262.9609,1038,266.9609,1034,262.9609" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="267" x="1034" y="244.895">determine FareProvider for each segment</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1069" y1="292.0938" y2="292.0938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1069" x2="1069" y1="292.0938" y2="305.0938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1028" x2="1069" y1="305.0938" y2="305.0938"/><polygon fill="#A80036" points="1038,301.0938,1028,305.0938,1038,309.0938,1034,305.0938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="1034" y="287.0278">create offer requests</text><path d="M955,320.0938 L1032,320.0938 L1032,327.0938 L1022,337.0938 L955,337.0938 L955,320.0938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="674" x="955" y="320.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="970" y="333.1606">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="1047" y="332.3042">[for each request]</text><polygon fill="#A80036" points="1555,354.3594,1565,358.3594,1555,362.3594,1559,358.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1561" y1="358.3594" y2="358.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="1034" y="353.2935">get offers</text><polygon fill="#A80036" points="1038,383.4922,1028,387.4922,1038,391.4922,1034,387.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1032" x2="1566" y1="387.4922" y2="387.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1044" y="382.4263">request with trips</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1069" y1="438.7578" y2="438.7578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1069" x2="1069" y1="438.7578" y2="451.7578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1028" x2="1069" y1="451.7578" y2="451.7578"/><polygon fill="#A80036" points="1038,447.7578,1028,451.7578,1038,455.7578,1034,451.7578" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="1034" y="418.5591">reconcile trips and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="1034" y="433.6919">construct global offers</text><polygon fill="#A80036" points="84,476.8906,74,480.8906,84,484.8906,80,480.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="78" x2="1026" y1="480.8906" y2="480.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="607" x="90" y="475.8247">&lt;Trips-offers-Collection with list of TripOffers scrolling tokens offerHashes combinationHashes&gt;</text><rect fill="#EEEEEE" filter="url(#f1ldm23e4a2han)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1649" x="0" y="509.457"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1649" y1="509.457" y2="509.457"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1649" y1="512.457" y2="512.457"/><rect fill="#EEEEEE" filter="url(#f1ldm23e4a2han)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="519" x="565" y="498.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="500" x="571" y="514.9575">Creating the trip collection &amp; getting the initial set of outward trips</text><path d="M10,539.0234 L80,539.0234 L80,546.0234 L70,556.0234 L10,556.0234 L10,539.0234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="406.7266" style="stroke:#000000;stroke-width:2.0;" width="1629" x="10" y="539.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="25" y="552.0903">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="398" x="95" y="551.2339">[working with offerHash to only get compatible inward offers]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="73" x2="115" y1="577.2891" y2="577.2891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="115" x2="115" y1="577.2891" y2="590.2891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74" x2="115" y1="590.2891" y2="590.2891"/><polygon fill="#A80036" points="84,586.2891,74,590.2891,84,594.2891,80,590.2891" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="422" x="80" y="572.2231">&lt;select outward offer or group of offers with the same offerHash&gt;</text><polygon fill="#A80036" points="1015,615.4219,1025,619.4219,1015,623.4219,1019,619.4219" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="73" x2="1021" y1="619.4219" y2="619.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="612" x="80" y="614.356">POST /Trips-offers-collection &lt;MUNCHEN-PARIS, 23/10/2021, outwardOfferHash, 2 pax, dob, ...&gt;</text><polygon fill="#A80036" points="1429,644.5547,1439,648.5547,1429,652.5547,1433,648.5547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1435" y1="648.5547" y2="648.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="390" x="1034" y="643.4888">&lt;retrieve trips information based on API Consumer request&gt;</text><polygon fill="#A80036" points="1038,673.6875,1028,677.6875,1038,681.6875,1034,677.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1032" x2="1440" y1="677.6875" y2="677.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="1044" y="672.6216">&lt;trips information&gt;</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1069" y1="706.8203" y2="706.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1069" x2="1069" y1="706.8203" y2="719.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1028" x2="1069" y1="719.8203" y2="719.8203"/><polygon fill="#A80036" points="1038,715.8203,1028,719.8203,1038,723.8203,1034,719.8203" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="267" x="1034" y="701.7544">determine FareProvider for each segment</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1069" y1="748.9531" y2="748.9531"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1069" x2="1069" y1="748.9531" y2="761.9531"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1028" x2="1069" y1="761.9531" y2="761.9531"/><polygon fill="#A80036" points="1038,757.9531,1028,761.9531,1038,765.9531,1034,761.9531" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="1034" y="743.8872">create offer requests</text><path d="M955,776.9531 L1032,776.9531 L1032,783.9531 L1022,793.9531 L955,793.9531 L955,776.9531 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="674" x="955" y="776.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="970" y="790.02">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="1047" y="789.1636">[for each request]</text><polygon fill="#A80036" points="1555,811.2188,1565,815.2188,1555,819.2188,1559,815.2188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1561" y1="815.2188" y2="815.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="1034" y="810.1528">get offers</text><polygon fill="#A80036" points="1038,840.3516,1028,844.3516,1038,848.3516,1034,844.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1032" x2="1566" y1="844.3516" y2="844.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1044" y="839.2856">request with trips</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1069" y1="895.6172" y2="895.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1069" x2="1069" y1="895.6172" y2="908.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1028" x2="1069" y1="908.6172" y2="908.6172"/><polygon fill="#A80036" points="1038,904.6172,1028,908.6172,1038,912.6172,1034,908.6172" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="1034" y="875.4185">reconcile trips and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="1034" y="890.5513">construct global offers</text><polygon fill="#A80036" points="84,933.75,74,937.75,84,941.75,80,937.75" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="78" x2="1026" y1="937.75" y2="937.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="930" x="90" y="932.6841">&lt;Trips-offers-Collection with list of TripOffers compatible with (set of) indicated outward Offer(s) scrolling tokens offerHashes combinationHashes&gt;</text><path d="M10,959.75 L80,959.75 L80,966.75 L70,976.75 L10,976.75 L10,959.75 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="406.7266" style="stroke:#000000;stroke-width:2.0;" width="1629" x="10" y="959.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="25" y="972.8169">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="571" x="95" y="971.9604">[working with combinationHashes to determine compatible offers on API_Consumer side]</text><polygon fill="#A80036" points="1015,994.0156,1025,998.0156,1015,1002.0156,1019,998.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="73" x2="1021" y1="998.0156" y2="998.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="489" x="80" y="992.9497">POST /Trips-offers-collection &lt;MUNCHEN-PARIS, 23/10/2021, 2 pax, dob, ...&gt;</text><polygon fill="#A80036" points="1429,1023.1484,1439,1027.1484,1429,1031.1484,1433,1027.1484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1435" y1="1027.1484" y2="1027.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="390" x="1034" y="1022.0825">&lt;retrieve trips information based on API Consumer request&gt;</text><polygon fill="#A80036" points="1038,1052.2813,1028,1056.2813,1038,1060.2813,1034,1056.2813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1032" x2="1440" y1="1056.2813" y2="1056.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="1044" y="1051.2153">&lt;trips information&gt;</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1069" y1="1085.4141" y2="1085.4141"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1069" x2="1069" y1="1085.4141" y2="1098.4141"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1028" x2="1069" y1="1098.4141" y2="1098.4141"/><polygon fill="#A80036" points="1038,1094.4141,1028,1098.4141,1038,1102.4141,1034,1098.4141" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="267" x="1034" y="1080.3481">determine FareProvider for each segment</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1069" y1="1127.5469" y2="1127.5469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1069" x2="1069" y1="1127.5469" y2="1140.5469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1028" x2="1069" y1="1140.5469" y2="1140.5469"/><polygon fill="#A80036" points="1038,1136.5469,1028,1140.5469,1038,1144.5469,1034,1140.5469" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="1034" y="1122.481">create offer requests</text><path d="M955,1155.5469 L1032,1155.5469 L1032,1162.5469 L1022,1172.5469 L955,1172.5469 L955,1155.5469 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="674" x="955" y="1155.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="970" y="1168.6138">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="1047" y="1167.7573">[for each request]</text><polygon fill="#A80036" points="1555,1189.8125,1565,1193.8125,1555,1197.8125,1559,1193.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1561" y1="1193.8125" y2="1193.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="1034" y="1188.7466">get offers</text><polygon fill="#A80036" points="1038,1218.9453,1028,1222.9453,1038,1226.9453,1034,1222.9453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1032" x2="1566" y1="1222.9453" y2="1222.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1044" y="1217.8794">request with trips</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1027" x2="1069" y1="1274.2109" y2="1274.2109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1069" x2="1069" y1="1274.2109" y2="1287.2109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1028" x2="1069" y1="1287.2109" y2="1287.2109"/><polygon fill="#A80036" points="1038,1283.2109,1028,1287.2109,1038,1291.2109,1034,1287.2109" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="1034" y="1254.0122">reconcile trips and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="1034" y="1269.145">construct global offers</text><polygon fill="#A80036" points="84,1312.3438,74,1316.3438,84,1320.3438,80,1316.3438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="78" x2="1026" y1="1316.3438" y2="1316.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="930" x="90" y="1311.2778">&lt;Trips-offers-Collection with list of TripOffers compatible with (set of) indicated outward Offer(s) scrolling tokens offerHashes combinationHashes&gt;</text><line style="stroke:#A80036;stroke-width:1.0;" x1="73" x2="115" y1="1345.4766" y2="1345.4766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="115" x2="115" y1="1345.4766" y2="1358.4766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74" x2="115" y1="1358.4766" y2="1358.4766"/><polygon fill="#A80036" points="84,1354.4766,74,1358.4766,84,1362.4766,80,1358.4766" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="541" x="80" y="1340.4106">&lt;select compatible outward-inward offer pairs based on return combinationHashes&gt;</text><!--MD5=[d62000b36f9dd6588094041993079cb7]
@startuml
hide footbox

actor API_Consumer 

== Creating the trip collection & getting the initial set of outward trips ==
API_Consumer -> OSDM_Provider: POST /Trips-offers-collection <MUNCHEN-PARIS, 23/10/2021, return 25/10/2021, 2 pax, dob, ...>
OSDM_Provider -> Journey_Planner : <retrieve trips information based on API Consumer request>
Journey_Planner - -> OSDM_Provider : <trips information>
OSDM_Provider -> OSDM_Provider: determine FareProvider for each segment
OSDM_Provider -> OSDM_Provider : create offer requests
loop for each request
    OSDM_Provider -> FareProvider: get offers 
    FareProvider - -> OSDM_Provider : request with trips
end
OSDM_Provider -> OSDM_Provider : reconcile trips and \nconstruct global offers
OSDM_Provider - -> API_Consumer: <Trips-offers-Collection with list of TripOffers scrolling tokens offerHashes combinationHashes>

== Creating the trip collection & getting the initial set of outward trips ==
opt working with offerHash to only get compatible inward offers
API_Consumer -> API_Consumer: <select outward offer or group of offers with the same offerHash>
API_Consumer -> OSDM_Provider: POST /Trips-offers-collection <MUNCHEN-PARIS, 23/10/2021, outwardOfferHash, 2 pax, dob, ...>
OSDM_Provider -> Journey_Planner : <retrieve trips information based on API Consumer request>
Journey_Planner - -> OSDM_Provider : <trips information>
OSDM_Provider -> OSDM_Provider: determine FareProvider for each segment
OSDM_Provider -> OSDM_Provider : create offer requests
loop for each request
    OSDM_Provider -> FareProvider: get offers 
    FareProvider - -> OSDM_Provider : request with trips
end
OSDM_Provider -> OSDM_Provider : reconcile trips and \nconstruct global offers
OSDM_Provider - -> API_Consumer: <Trips-offers-Collection with list of TripOffers compatible with (set of) indicated outward Offer(s) scrolling tokens offerHashes combinationHashes>
end

opt working with combinationHashes to determine compatible offers on API_Consumer side
API_Consumer -> OSDM_Provider: POST /Trips-offers-collection <MUNCHEN-PARIS, 23/10/2021, 2 pax, dob, ...>
OSDM_Provider -> Journey_Planner : <retrieve trips information based on API Consumer request>
Journey_Planner - -> OSDM_Provider : <trips information>
OSDM_Provider -> OSDM_Provider: determine FareProvider for each segment
OSDM_Provider -> OSDM_Provider : create offer requests
loop for each request
    OSDM_Provider -> FareProvider: get offers 
    FareProvider - -> OSDM_Provider : request with trips
end
OSDM_Provider -> OSDM_Provider : reconcile trips and \nconstruct global offers
OSDM_Provider - -> API_Consumer: <Trips-offers-Collection with list of TripOffers compatible with (set of) indicated outward Offer(s) scrolling tokens offerHashes combinationHashes>
API_Consumer -> API_Consumer: <select compatible outward-inward offer pairs based on return combinationHashes>
end
@enduml

PlantUML version 1.2020.22(Sun Dec 06 10:36:27 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>