
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1390px" preserveAspectRatio="none" style="width:1606px;height:1390px;" version="1.1" viewBox="0 0 1606 1390" width="1606px" zoomAndPan="magnify"><defs><filter height="300%" id="fr309htxk5p60" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fr309htxk5p60)" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="683" x="896" y="320.0938"/><rect fill="#FFFFFF" filter="url(#fr309htxk5p60)" height="406.7266" style="stroke:#000000;stroke-width:2.0;" width="1579" x="10" y="539.0234"/><rect fill="#FFFFFF" filter="url(#fr309htxk5p60)" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="683" x="896" y="776.9531"/><rect fill="#FFFFFF" filter="url(#fr309htxk5p60)" height="406.7266" style="stroke:#000000;stroke-width:2.0;" width="1579" x="10" y="959.75"/><rect fill="#FFFFFF" filter="url(#fr309htxk5p60)" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="683" x="896" y="1155.5469"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="74" x2="74" y1="88.2969" y2="1383.4766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="970" x2="970" y1="88.2969" y2="1383.4766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1384" x2="1384" y1="88.2969" y2="1383.4766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1514" x2="1514" y1="88.2969" y2="1383.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="20" y="84.9951">API_Consumer</text><ellipse cx="74" cy="15" fill="#FEFECE" filter="url(#fr309htxk5p60)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M74,23 L74,50 M61,31 L87,31 M74,50 L61,65 M74,50 L87,65 " fill="none" filter="url(#fr309htxk5p60)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#fr309htxk5p60)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="124" x="906" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="913" y="72.9951">OSDM_Provider</text><rect fill="#FEFECE" filter="url(#fr309htxk5p60)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="128" x="1318" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="1325" y="72.9951">Journey_Planner</text><rect fill="#FEFECE" filter="url(#fr309htxk5p60)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="105" x="1460" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="1467" y="72.9951">FareProvider</text><rect fill="#EEEEEE" filter="url(#fr309htxk5p60)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1599" x="0" y="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1599" y1="118.8633" y2="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1599" y1="121.8633" y2="121.8633"/><rect fill="#EEEEEE" filter="url(#fr309htxk5p60)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="662" x="468.5" y="108.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="643" x="474.5" y="124.3638">Creating the outward tripOffers collection &amp; getting the initial set of outward trips</text><polygon fill="#A80036" points="958,158.5625,968,162.5625,958,166.5625,962,162.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74" x2="964" y1="162.5625" y2="162.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="609" x="81" y="157.4966">POST /Trips-offers-collection &lt;MUNCHEN-PARIS, 23/10/2021, return 25/10/2021, 2 pax, dob, ...&gt;</text><polygon fill="#A80036" points="1372,187.6953,1382,191.6953,1372,195.6953,1376,191.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1378" y1="191.6953" y2="191.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="390" x="977" y="186.6294">&lt;retrieve trips information based on API Consumer request&gt;</text><polygon fill="#A80036" points="981,216.8281,971,220.8281,981,224.8281,977,220.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="1383" y1="220.8281" y2="220.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="987" y="215.7622">&lt;trips information&gt;</text><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1012" y1="249.9609" y2="249.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1012" x2="1012" y1="249.9609" y2="262.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="971" x2="1012" y1="262.9609" y2="262.9609"/><polygon fill="#A80036" points="981,258.9609,971,262.9609,981,266.9609,977,262.9609" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269" x="977" y="244.895">determine FareProvider for each segment</text><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1012" y1="292.0938" y2="292.0938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1012" x2="1012" y1="292.0938" y2="305.0938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="971" x2="1012" y1="305.0938" y2="305.0938"/><polygon fill="#A80036" points="981,301.0938,971,305.0938,981,309.0938,977,305.0938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="977" y="287.0278">create offer requests</text><path d="M896,320.0938 L974,320.0938 L974,327.0938 L964,337.0938 L896,337.0938 L896,320.0938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="683" x="896" y="320.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="911" y="333.1606">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="123" x="989" y="332.3042">[for each request]</text><polygon fill="#A80036" points="1502.5,354.3594,1512.5,358.3594,1502.5,362.3594,1506.5,358.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1508.5" y1="358.3594" y2="358.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="977" y="353.2935">get offers</text><polygon fill="#A80036" points="981,383.4922,971,387.4922,981,391.4922,977,387.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="1513.5" y1="387.4922" y2="387.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="987" y="382.4263">request with trips</text><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1012" y1="438.7578" y2="438.7578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1012" x2="1012" y1="438.7578" y2="451.7578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="971" x2="1012" y1="451.7578" y2="451.7578"/><polygon fill="#A80036" points="981,447.7578,971,451.7578,981,455.7578,977,451.7578" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="977" y="418.5591">reconcile trips and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="977" y="433.6919">construct global offers</text><polygon fill="#A80036" points="85,476.8906,75,480.8906,85,484.8906,81,480.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="79" x2="969" y1="480.8906" y2="480.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="542" x="91" y="475.8247">&lt;Trips-offers-Collection with list of TripOffers scrolling tokens offerTags returnTags&gt;</text><rect fill="#EEEEEE" filter="url(#fr309htxk5p60)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1599" x="0" y="509.457"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1599" y1="509.457" y2="509.457"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1599" y1="512.457" y2="512.457"/><rect fill="#EEEEEE" filter="url(#fr309htxk5p60)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="324" x="637.5" y="498.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="305" x="643.5" y="514.9575">Getting the inward tripOffers collection</text><path d="M10,539.0234 L82,539.0234 L82,546.0234 L72,556.0234 L10,556.0234 L10,539.0234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="406.7266" style="stroke:#000000;stroke-width:2.0;" width="1579" x="10" y="539.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="25" y="552.0903">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="415" x="97" y="551.2339">[working with offerTag to only get compatible inward offers]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="74" x2="116" y1="577.2891" y2="577.2891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="116" x2="116" y1="577.2891" y2="590.2891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="75" x2="116" y1="590.2891" y2="590.2891"/><polygon fill="#A80036" points="85,586.2891,75,590.2891,85,594.2891,81,590.2891" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="422" x="81" y="572.2231">&lt;select outward offer or group of offers with the same offerTag&gt;</text><polygon fill="#A80036" points="958,615.4219,968,619.4219,958,623.4219,962,619.4219" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74" x2="964" y1="619.4219" y2="619.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="604" x="81" y="614.356">POST /Trips-offers-collection &lt;MUNCHEN-PARIS, 23/10/2021, outwardOfferTag, 2 pax, dob, ...&gt;</text><polygon fill="#A80036" points="1372,644.5547,1382,648.5547,1372,652.5547,1376,648.5547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1378" y1="648.5547" y2="648.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="390" x="977" y="643.4888">&lt;retrieve trips information based on API Consumer request&gt;</text><polygon fill="#A80036" points="981,673.6875,971,677.6875,981,681.6875,977,677.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="1383" y1="677.6875" y2="677.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="987" y="672.6216">&lt;trips information&gt;</text><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1012" y1="706.8203" y2="706.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1012" x2="1012" y1="706.8203" y2="719.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="971" x2="1012" y1="719.8203" y2="719.8203"/><polygon fill="#A80036" points="981,715.8203,971,719.8203,981,723.8203,977,719.8203" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269" x="977" y="701.7544">determine FareProvider for each segment</text><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1012" y1="748.9531" y2="748.9531"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1012" x2="1012" y1="748.9531" y2="761.9531"/><line style="stroke:#A80036;stroke-width:1.0;" x1="971" x2="1012" y1="761.9531" y2="761.9531"/><polygon fill="#A80036" points="981,757.9531,971,761.9531,981,765.9531,977,761.9531" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="977" y="743.8872">create offer requests</text><path d="M896,776.9531 L974,776.9531 L974,783.9531 L964,793.9531 L896,793.9531 L896,776.9531 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="683" x="896" y="776.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="911" y="790.02">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="123" x="989" y="789.1636">[for each request]</text><polygon fill="#A80036" points="1502.5,811.2188,1512.5,815.2188,1502.5,819.2188,1506.5,815.2188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1508.5" y1="815.2188" y2="815.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="977" y="810.1528">get offers</text><polygon fill="#A80036" points="981,840.3516,971,844.3516,981,848.3516,977,844.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="1513.5" y1="844.3516" y2="844.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="987" y="839.2856">request with trips</text><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1012" y1="895.6172" y2="895.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1012" x2="1012" y1="895.6172" y2="908.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="971" x2="1012" y1="908.6172" y2="908.6172"/><polygon fill="#A80036" points="981,904.6172,971,908.6172,981,912.6172,977,908.6172" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="977" y="875.4185">reconcile trips and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="977" y="890.5513">construct global offers</text><polygon fill="#A80036" points="85,933.75,75,937.75,85,941.75,81,937.75" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="79" x2="969" y1="937.75" y2="937.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="872" x="91" y="932.6841">&lt;Trips-offers-Collection with list of TripOffers compatible with (set of) indicated outward Offer(s) scrolling tokens offerTags returnTags&gt;</text><path d="M10,959.75 L82,959.75 L82,966.75 L72,976.75 L10,976.75 L10,959.75 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="406.7266" style="stroke:#000000;stroke-width:2.0;" width="1579" x="10" y="959.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="25" y="972.8169">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="545" x="97" y="971.9604">[working with returnTags to determine compatible offers on API_Consumer side]</text><polygon fill="#A80036" points="958,994.0156,968,998.0156,958,1002.0156,962,998.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74" x2="964" y1="998.0156" y2="998.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="486" x="81" y="992.9497">POST /Trips-offers-collection &lt;MUNCHEN-PARIS, 23/10/2021, 2 pax, dob, ...&gt;</text><polygon fill="#A80036" points="1372,1023.1484,1382,1027.1484,1372,1031.1484,1376,1027.1484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1378" y1="1027.1484" y2="1027.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="390" x="977" y="1022.0825">&lt;retrieve trips information based on API Consumer request&gt;</text><polygon fill="#A80036" points="981,1052.2813,971,1056.2813,981,1060.2813,977,1056.2813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="1383" y1="1056.2813" y2="1056.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="987" y="1051.2153">&lt;trips information&gt;</text><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1012" y1="1085.4141" y2="1085.4141"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1012" x2="1012" y1="1085.4141" y2="1098.4141"/><line style="stroke:#A80036;stroke-width:1.0;" x1="971" x2="1012" y1="1098.4141" y2="1098.4141"/><polygon fill="#A80036" points="981,1094.4141,971,1098.4141,981,1102.4141,977,1098.4141" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269" x="977" y="1080.3481">determine FareProvider for each segment</text><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1012" y1="1127.5469" y2="1127.5469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1012" x2="1012" y1="1127.5469" y2="1140.5469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="971" x2="1012" y1="1140.5469" y2="1140.5469"/><polygon fill="#A80036" points="981,1136.5469,971,1140.5469,981,1144.5469,977,1140.5469" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="977" y="1122.481">create offer requests</text><path d="M896,1155.5469 L974,1155.5469 L974,1162.5469 L964,1172.5469 L896,1172.5469 L896,1155.5469 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="683" x="896" y="1155.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="911" y="1168.6138">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="123" x="989" y="1167.7573">[for each request]</text><polygon fill="#A80036" points="1502.5,1189.8125,1512.5,1193.8125,1502.5,1197.8125,1506.5,1193.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1508.5" y1="1193.8125" y2="1193.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="977" y="1188.7466">get offers</text><polygon fill="#A80036" points="981,1218.9453,971,1222.9453,981,1226.9453,977,1222.9453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="1513.5" y1="1222.9453" y2="1222.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="987" y="1217.8794">request with trips</text><line style="stroke:#A80036;stroke-width:1.0;" x1="970" x2="1012" y1="1274.2109" y2="1274.2109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1012" x2="1012" y1="1274.2109" y2="1287.2109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="971" x2="1012" y1="1287.2109" y2="1287.2109"/><polygon fill="#A80036" points="981,1283.2109,971,1287.2109,981,1291.2109,977,1287.2109" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="977" y="1254.0122">reconcile trips and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="977" y="1269.145">construct global offers</text><polygon fill="#A80036" points="85,1312.3438,75,1316.3438,85,1320.3438,81,1316.3438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="79" x2="969" y1="1316.3438" y2="1316.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="872" x="91" y="1311.2778">&lt;Trips-offers-Collection with list of TripOffers compatible with (set of) indicated outward Offer(s) scrolling tokens offerTags returnTags&gt;</text><line style="stroke:#A80036;stroke-width:1.0;" x1="74" x2="116" y1="1345.4766" y2="1345.4766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="116" x2="116" y1="1345.4766" y2="1358.4766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="75" x2="116" y1="1358.4766" y2="1358.4766"/><polygon fill="#A80036" points="85,1354.4766,75,1358.4766,85,1362.4766,81,1358.4766" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="445" x="81" y="1340.4106">&lt;select compatible outward-inward offer pairs based on returnTags&gt;</text><!--MD5=[ab6fd42aec76255715ba0381bc428557]
@startuml
hide footbox

actor API_Consumer 

== Creating the outward tripOffers collection & getting the initial set of outward trips ==
API_Consumer -> OSDM_Provider: POST /Trips-offers-collection <MUNCHEN-PARIS, 23/10/2021, return 25/10/2021, 2 pax, dob, ...>
OSDM_Provider -> Journey_Planner : <retrieve trips information based on API Consumer request>
Journey_Planner - -> OSDM_Provider : <trips information>
OSDM_Provider -> OSDM_Provider: determine FareProvider for each segment
OSDM_Provider -> OSDM_Provider : create offer requests
loop for each request
    OSDM_Provider -> FareProvider: get offers 
    FareProvider - -> OSDM_Provider : request with trips
end
OSDM_Provider -> OSDM_Provider : reconcile trips and \nconstruct global offers
OSDM_Provider - -> API_Consumer: <Trips-offers-Collection with list of TripOffers scrolling tokens offerTags returnTags>

== Getting the inward tripOffers collection ==
opt working with offerTag to only get compatible inward offers
API_Consumer -> API_Consumer: <select outward offer or group of offers with the same offerTag>
API_Consumer -> OSDM_Provider: POST /Trips-offers-collection <MUNCHEN-PARIS, 23/10/2021, outwardOfferTag, 2 pax, dob, ...>
OSDM_Provider -> Journey_Planner : <retrieve trips information based on API Consumer request>
Journey_Planner - -> OSDM_Provider : <trips information>
OSDM_Provider -> OSDM_Provider: determine FareProvider for each segment
OSDM_Provider -> OSDM_Provider : create offer requests
loop for each request
    OSDM_Provider -> FareProvider: get offers 
    FareProvider - -> OSDM_Provider : request with trips
end
OSDM_Provider -> OSDM_Provider : reconcile trips and \nconstruct global offers
OSDM_Provider - -> API_Consumer: <Trips-offers-Collection with list of TripOffers compatible with (set of) indicated outward Offer(s) scrolling tokens offerTags returnTags>
end

opt working with returnTags to determine compatible offers on API_Consumer side
API_Consumer -> OSDM_Provider: POST /Trips-offers-collection <MUNCHEN-PARIS, 23/10/2021, 2 pax, dob, ...>
OSDM_Provider -> Journey_Planner : <retrieve trips information based on API Consumer request>
Journey_Planner - -> OSDM_Provider : <trips information>
OSDM_Provider -> OSDM_Provider: determine FareProvider for each segment
OSDM_Provider -> OSDM_Provider : create offer requests
loop for each request
    OSDM_Provider -> FareProvider: get offers 
    FareProvider - -> OSDM_Provider : request with trips
end
OSDM_Provider -> OSDM_Provider : reconcile trips and \nconstruct global offers
OSDM_Provider - -> API_Consumer: <Trips-offers-Collection with list of TripOffers compatible with (set of) indicated outward Offer(s) scrolling tokens offerTags returnTags>
API_Consumer -> API_Consumer: <select compatible outward-inward offer pairs based on returnTags>
end
@enduml

PlantUML version 1.2021.2beta6(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>