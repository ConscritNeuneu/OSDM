<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2235px" preserveAspectRatio="none" style="width:1564px;height:2235px;" version="1.1" viewBox="0 0 1564 2235" width="1564px" zoomAndPan="magnify"><defs><filter height="300%" id="f1fm958mbs3x4w" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1fm958mbs3x4w)" height="90.3984" style="stroke:#000000;stroke-width:2.0;" width="261" x="545" y="235.8281"/><rect fill="#FFFFFF" filter="url(#f1fm958mbs3x4w)" height="59.2656" style="stroke:#000000;stroke-width:2.0;" width="241" x="555" y="259.9609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="58" x2="58" y1="88.2969" y2="2228.7969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="627" x2="627" y1="88.2969" y2="2228.7969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1041" x2="1041" y1="88.2969" y2="2228.7969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1171" x2="1171" y1="88.2969" y2="2228.7969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1364" x2="1364" y1="88.2969" y2="2228.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="5" y="84.9951">API_Consumer</text><ellipse cx="58" cy="15" fill="#FEFECE" filter="url(#f1fm958mbs3x4w)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M58,23 L58,50 M45,31 L71,31 M58,50 L45,65 M58,50 L71,65 " fill="none" filter="url(#f1fm958mbs3x4w)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1fm958mbs3x4w)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="120" x="565" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="572" y="72.9951">OSDM_Provider</text><rect fill="#FEFECE" filter="url(#f1fm958mbs3x4w)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="124" x="977" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="984" y="72.9951">Journey_Planner</text><rect fill="#FEFECE" filter="url(#f1fm958mbs3x4w)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="109" x="1115" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="95" x="1122" y="72.9951">FareProvider1</text><rect fill="#FEFECE" filter="url(#f1fm958mbs3x4w)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="109" x="1308" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="95" x="1315" y="72.9951">FareProvider2</text><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1557.5" x="0" y="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="118.8633" y2="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="121.8633" y2="121.8633"/><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="453" x="552.25" y="108.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="434" x="558.25" y="124.3638">Creating the trip collection &amp; getting the initial set of trips</text><polygon fill="#A80036" points="615,158.5625,625,162.5625,615,166.5625,619,162.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="58" x2="621" y1="162.5625" y2="162.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="489" x="65" y="157.4966">POST /Trips-offers-collection &lt;MUNCHEN-PARIS, 23/10/2021, 2 pax, dob, ...&gt;</text><polygon fill="#A80036" points="1029,187.6953,1039,191.6953,1029,195.6953,1033,191.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="1035" y1="191.6953" y2="191.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="390" x="634" y="186.6294">&lt;retrieve trips information based on API Consumer request&gt;</text><polygon fill="#A80036" points="638,216.8281,628,220.8281,638,224.8281,634,220.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="632" x2="1040" y1="220.8281" y2="220.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="644" y="215.7622">&lt;trips information&gt;</text><path d="M545,235.8281 L622,235.8281 L622,242.8281 L612,252.8281 L545,252.8281 L545,235.8281 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="90.3984" style="stroke:#000000;stroke-width:2.0;" width="261" x="545" y="235.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="560" y="248.895">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="89" x="637" y="248.0386">[for each trip]</text><path d="M555,259.9609 L632,259.9609 L632,266.9609 L622,276.9609 L555,276.9609 L555,259.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:2.0;" width="241" x="555" y="259.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="570" y="273.0278">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="122" x="647" y="272.1714">[for each segment]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="669" y1="298.2266" y2="298.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="669" x2="669" y1="298.2266" y2="311.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="628" x2="669" y1="311.2266" y2="311.2266"/><polygon fill="#A80036" points="638,307.2266,628,311.2266,638,315.2266,634,311.2266" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="634" y="293.1606">determine FareProvider</text><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="669" y1="354.3594" y2="354.3594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="669" x2="669" y1="354.3594" y2="367.3594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="628" x2="669" y1="367.3594" y2="367.3594"/><polygon fill="#A80036" points="638,363.3594,628,367.3594,638,371.3594,634,367.3594" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="634" y="349.2935">create offer requests</text><polygon fill="#A80036" points="1159.5,392.4922,1169.5,396.4922,1159.5,400.4922,1163.5,396.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="1165.5" y1="396.4922" y2="396.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="634" y="391.4263">get offers</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1171.5" x2="1213.5" y1="425.625" y2="425.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1213.5" x2="1213.5" y1="425.625" y2="438.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1172.5" x2="1213.5" y1="438.625" y2="438.625"/><polygon fill="#A80036" points="1182.5,434.625,1172.5,438.625,1182.5,442.625,1178.5,438.625" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="1178.5" y="420.5591">calculate offers</text><polygon fill="#A80036" points="638,463.7578,628,467.7578,638,471.7578,634,467.7578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="632" x2="1170.5" y1="467.7578" y2="467.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="644" y="462.6919">request with trips</text><polygon fill="#A80036" points="1352.5,492.8906,1362.5,496.8906,1352.5,500.8906,1356.5,496.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="1358.5" y1="496.8906" y2="496.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="634" y="491.8247">get offers</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1364.5" x2="1406.5" y1="526.0234" y2="526.0234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1406.5" x2="1406.5" y1="526.0234" y2="539.0234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1365.5" x2="1406.5" y1="539.0234" y2="539.0234"/><polygon fill="#A80036" points="1375.5,535.0234,1365.5,539.0234,1375.5,543.0234,1371.5,539.0234" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="1371.5" y="520.9575">calculate offers</text><polygon fill="#A80036" points="638,564.1563,628,568.1563,638,572.1563,634,568.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="632" x2="1363.5" y1="568.1563" y2="568.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="644" y="563.0903">request with trips</text><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="669" y1="612.4219" y2="612.4219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="669" x2="669" y1="612.4219" y2="625.4219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="628" x2="669" y1="625.4219" y2="625.4219"/><polygon fill="#A80036" points="638,621.4219,628,625.4219,638,629.4219,634,625.4219" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="634" y="592.2231">reconcile trips and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="634" y="607.356">construct global offers</text><polygon fill="#A80036" points="69,650.5547,59,654.5547,69,658.5547,65,654.5547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="63" x2="626" y1="654.5547" y2="654.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="510" x="75" y="649.4888">&lt;Trips-offers-Collection with list of references to tripOffers and scrolling tokens&gt;</text><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1557.5" x="0" y="683.1211"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="683.1211" y2="683.1211"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="686.1211" y2="686.1211"/><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="635" x="461.25" y="672.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="621" x="467.25" y="688.6216">Retrieving an offer &amp; setting seat selection options, starting with tripoffer overview</text><polygon fill="#A80036" points="615,722.8203,625,726.8203,615,730.8203,619,726.8203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="58" x2="621" y1="726.8203" y2="726.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="520" x="65" y="721.7544">GET /Trips-offers/5678?embed="TRIPOFFERS.OFFERS, TRIPOFFERS.PASSENGERS "</text><polygon fill="#A80036" points="69,751.9531,59,755.9531,69,759.9531,65,755.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="63" x2="626" y1="755.9531" y2="755.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="309" x="75" y="750.8872">&lt;Trip-offer 5678 with its offers and passengers&gt;</text><polygon fill="#A80036" points="615,781.0859,625,785.0859,615,789.0859,619,785.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="58" x2="621" y1="785.0859" y2="785.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="312" x="65" y="780.02">GET /offers/8765?embed="OFFERS.OFFERPARTS"</text><polygon fill="#A80036" points="69,810.2188,59,814.2188,69,818.2188,65,814.2188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="63" x2="626" y1="814.2188" y2="814.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="75" y="809.1528">&lt;offer 8765 with its offerparts&gt;</text><polygon fill="#A80036" points="615,854.4844,625,858.4844,615,862.4844,619,858.4844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="58" x2="621" y1="858.4844" y2="858.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="65" y="838.2856">PATCH /Offers/8765/reservations/7654/</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="545" x="65" y="853.4185">&lt;reservation with selectedPlaces or selectedOptions set with desired seating option&gt;</text><polygon fill="#A80036" points="69,883.6172,59,887.6172,69,891.6172,65,887.6172" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="63" x2="626" y1="887.6172" y2="887.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="394" x="75" y="882.5513">&lt;updated reservation 7654 with desired reservation options&gt;</text><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1557.5" x="0" y="916.1836"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="916.1836" y2="916.1836"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="919.1836" y2="919.1836"/><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="936" x="310.75" y="905.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="917" x="316.75" y="921.6841">setting additional passenger information that may be required for provisional booking, starting from the tripoffer overview</text><line style="stroke:#A80036;stroke-width:1.0;" x1="58" x2="100" y1="959.8828" y2="959.8828"/><line style="stroke:#A80036;stroke-width:1.0;" x1="100" x2="100" y1="959.8828" y2="972.8828"/><line style="stroke:#A80036;stroke-width:1.0;" x1="59" x2="100" y1="972.8828" y2="972.8828"/><polygon fill="#A80036" points="69,968.8828,59,972.8828,69,976.8828,65,972.8828" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="215" x="65" y="954.8169">check offer RequestedInformation</text><polygon fill="#A80036" points="615,998.0156,625,1002.0156,615,1006.0156,619,1002.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="58" x2="621" y1="1002.0156" y2="1002.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="520" x="65" y="996.9497">PATCH /Offers/8765/passengers/123 &lt; additional information for passenger 123&gt;</text><polygon fill="#A80036" points="69,1027.1484,59,1031.1484,69,1035.1484,65,1031.1484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="63" x2="626" y1="1031.1484" y2="1031.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="321" x="75" y="1026.0825">&lt;passenger updated with the added information&gt;</text><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1557.5" x="0" y="1059.7148"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="1059.7148" y2="1059.7148"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="1062.7148" y2="1062.7148"/><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="391" x="583.25" y="1049.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="372" x="589.25" y="1065.2153">Creating a booking based on one or more offer(s)</text><polygon fill="#A80036" points="615,1099.4141,625,1103.4141,615,1107.4141,619,1103.4141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="58" x2="621" y1="1103.4141" y2="1103.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="65" y="1098.3481">POST /bookings/ &lt;offerId= 8765&gt;</text><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="669" y1="1132.5469" y2="1132.5469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="669" x2="669" y1="1132.5469" y2="1145.5469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="628" x2="669" y1="1145.5469" y2="1145.5469"/><polygon fill="#A80036" points="638,1141.5469,628,1145.5469,638,1149.5469,634,1145.5469" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="634" y="1127.481">create local booking 5678</text><polygon fill="#A80036" points="1159.5,1170.6797,1169.5,1174.6797,1159.5,1178.6797,1163.5,1174.6797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="1165.5" y1="1174.6797" y2="1174.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="634" y="1169.6138">provisionally book offerpart1</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1171.5" x2="1213.5" y1="1203.8125" y2="1203.8125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1213.5" x2="1213.5" y1="1203.8125" y2="1216.8125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1172.5" x2="1213.5" y1="1216.8125" y2="1216.8125"/><polygon fill="#A80036" points="1182.5,1212.8125,1172.5,1216.8125,1182.5,1220.8125,1178.5,1216.8125" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="1178.5" y="1198.7466">create FareProvider booking</text><polygon fill="#A80036" points="638,1241.9453,628,1245.9453,638,1249.9453,634,1245.9453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="632" x2="1170.5" y1="1245.9453" y2="1245.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="644" y="1240.8794">OK response (can vary per FareProvider)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="669" y1="1275.0781" y2="1275.0781"/><line style="stroke:#A80036;stroke-width:1.0;" x1="669" x2="669" y1="1275.0781" y2="1288.0781"/><line style="stroke:#A80036;stroke-width:1.0;" x1="628" x2="669" y1="1288.0781" y2="1288.0781"/><polygon fill="#A80036" points="638,1284.0781,628,1288.0781,638,1292.0781,634,1288.0781" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="634" y="1270.0122">add FareProvider booking to local booking</text><polygon fill="#A80036" points="1352.5,1313.2109,1362.5,1317.2109,1352.5,1321.2109,1356.5,1317.2109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="1358.5" y1="1317.2109" y2="1317.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="634" y="1312.145">provisionally book offerpart2</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1364.5" x2="1406.5" y1="1346.3438" y2="1346.3438"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1406.5" x2="1406.5" y1="1346.3438" y2="1359.3438"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1365.5" x2="1406.5" y1="1359.3438" y2="1359.3438"/><polygon fill="#A80036" points="1375.5,1355.3438,1365.5,1359.3438,1375.5,1363.3438,1371.5,1359.3438" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="1371.5" y="1341.2778">create FareProvider booking</text><polygon fill="#A80036" points="638,1384.4766,628,1388.4766,638,1392.4766,634,1388.4766" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="632" x2="1363.5" y1="1388.4766" y2="1388.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="644" y="1383.4106">OK response (can vary per FareProvider)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="669" y1="1417.6094" y2="1417.6094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="669" x2="669" y1="1417.6094" y2="1430.6094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="628" x2="669" y1="1430.6094" y2="1430.6094"/><polygon fill="#A80036" points="638,1426.6094,628,1430.6094,638,1434.6094,634,1430.6094" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="634" y="1412.5435">add FareProvider booking to local booking</text><polygon fill="#A80036" points="69,1455.7422,59,1459.7422,69,1463.7422,65,1459.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="63" x2="626" y1="1459.7422" y2="1459.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="493" x="75" y="1454.6763">&lt;Created Booking 5678 with references to Trips, booked offers, passengers&gt;</text><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1557.5" x="0" y="1488.3086"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="1488.3086" y2="1488.3086"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="1491.3086" y2="1491.3086"/><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="933" x="312.25" y="1477.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="914" x="318.25" y="1493.8091">setting additional passenger information that may be required to confirm the booking, starting from the booking overview</text><polygon fill="#A80036" points="615,1528.0078,625,1532.0078,615,1536.0078,619,1532.0078" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="58" x2="621" y1="1532.0078" y2="1532.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="504" x="65" y="1526.9419">GET /Bookings/5678?embed="BOOKEDOFFERS,BOOKEDOFFERS.PASSENGERS"</text><polygon fill="#A80036" points="69,1557.1406,59,1561.1406,69,1565.1406,65,1561.1406" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="63" x2="626" y1="1561.1406" y2="1561.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="366" x="75" y="1556.0747">&lt;Booking with booked offers and passengers resources&gt;</text><line style="stroke:#A80036;stroke-width:1.0;" x1="58" x2="100" y1="1590.2734" y2="1590.2734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="100" x2="100" y1="1590.2734" y2="1603.2734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="59" x2="100" y1="1603.2734" y2="1603.2734"/><polygon fill="#A80036" points="69,1599.2734,59,1603.2734,69,1607.2734,65,1603.2734" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="65" y="1585.2075">check booking RequestedInformation</text><polygon fill="#A80036" points="615,1628.4063,625,1632.4063,615,1636.4063,619,1632.4063" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="58" x2="621" y1="1632.4063" y2="1632.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="516" x="65" y="1627.3403">PATCH /Bookings/5678/passengers/123/ &lt; additional information for passenger&gt;</text><polygon fill="#A80036" points="1159.5,1657.5391,1169.5,1661.5391,1159.5,1665.5391,1163.5,1661.5391" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="1165.5" y1="1661.5391" y2="1661.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="634" y="1656.4731">update passenger data</text><polygon fill="#A80036" points="638,1686.6719,628,1690.6719,638,1694.6719,634,1690.6719" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="632" x2="1170.5" y1="1690.6719" y2="1690.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="644" y="1685.606">OK response (can vary per FareProvider)</text><polygon fill="#A80036" points="1352.5,1715.8047,1362.5,1719.8047,1352.5,1723.8047,1356.5,1719.8047" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="1358.5" y1="1719.8047" y2="1719.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="634" y="1714.7388">update passenger data</text><polygon fill="#A80036" points="638,1744.9375,628,1748.9375,638,1752.9375,634,1748.9375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="632" x2="1363.5" y1="1748.9375" y2="1748.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="644" y="1743.8716">OK response (can vary per FareProvider)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="669" y1="1778.0703" y2="1778.0703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="669" x2="669" y1="1778.0703" y2="1791.0703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="628" x2="669" y1="1791.0703" y2="1791.0703"/><polygon fill="#A80036" points="638,1787.0703,628,1791.0703,638,1795.0703,634,1791.0703" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="634" y="1773.0044">update local booking 5678</text><polygon fill="#A80036" points="69,1816.2031,59,1820.2031,69,1824.2031,65,1820.2031" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="63" x2="626" y1="1820.2031" y2="1820.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="349" x="75" y="1815.1372">&lt;passenger 123 updated with the added information&gt;</text><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1557.5" x="0" y="1848.7695"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="1848.7695" y2="1848.7695"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="1851.7695" y2="1851.7695"/><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="309" x="624.25" y="1838.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="290" x="630.25" y="1854.27">setting fulfillment type for the booking</text><polygon fill="#A80036" points="69,1888.4688,59,1892.4688,69,1896.4688,65,1892.4688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="63" x2="626" y1="1892.4688" y2="1892.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="361" x="75" y="1887.4028">&lt;Booking with only references to embedded resources&gt;</text><polygon fill="#A80036" points="615,1917.6016,625,1921.6016,615,1925.6016,619,1921.6016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="58" x2="621" y1="1921.6016" y2="1921.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="355" x="65" y="1916.5356">PATCH /Bookings/5678 &lt;setting the fulfillmentOptions&gt;</text><polygon fill="#A80036" points="69,1946.7344,59,1950.7344,69,1954.7344,65,1950.7344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="63" x2="626" y1="1950.7344" y2="1950.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="334" x="75" y="1945.6685">&lt;Booking resource with updated fulfillmentOptions&gt;</text><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1557.5" x="0" y="1979.3008"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="1979.3008" y2="1979.3008"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1557.5" y1="1982.3008" y2="1982.3008"/><rect fill="#EEEEEE" filter="url(#f1fm958mbs3x4w)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="338" x="609.75" y="1968.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="319" x="615.75" y="1984.8013">confirming booking &amp; triggering fulfillment</text><polygon fill="#A80036" points="615,2019,625,2023,615,2027,619,2023" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="58" x2="621" y1="2023" y2="2023"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="65" y="2017.9341">POST /Bookings/5678/Fulfillments</text><polygon fill="#A80036" points="1159.5,2048.1328,1169.5,2052.1328,1159.5,2056.1328,1163.5,2052.1328" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="1165.5" y1="2052.1328" y2="2052.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="634" y="2047.0669">confirm &amp; fulfill booking</text><polygon fill="#A80036" points="638,2077.2656,628,2081.2656,638,2085.2656,634,2081.2656" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="632" x2="1170.5" y1="2081.2656" y2="2081.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="644" y="2076.1997">OK response (can vary per FareProvider)</text><polygon fill="#A80036" points="1352.5,2106.3984,1362.5,2110.3984,1352.5,2114.3984,1356.5,2110.3984" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="1358.5" y1="2110.3984" y2="2110.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="634" y="2105.3325">confirm &amp; fulfill booking</text><polygon fill="#A80036" points="638,2135.5313,628,2139.5313,638,2143.5313,634,2139.5313" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="632" x2="1363.5" y1="2139.5313" y2="2139.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="644" y="2134.4653">OK response (can vary per FareProvider)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="627" x2="669" y1="2168.6641" y2="2168.6641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="669" x2="669" y1="2168.6641" y2="2181.6641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="628" x2="669" y1="2181.6641" y2="2181.6641"/><polygon fill="#A80036" points="638,2177.6641,628,2181.6641,638,2185.6641,634,2181.6641" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="330" x="634" y="2163.5981">update local statuses &amp; create fulfillment resources</text><polygon fill="#A80036" points="69,2206.7969,59,2210.7969,69,2214.7969,65,2210.7969" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="63" x2="626" y1="2210.7969" y2="2210.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="75" y="2205.731">&lt;Fulfillments created in the booking 5678&gt;</text><!--MD5=[071b748e4ec29108488c0d94d384674c]
@startuml
hide footbox

actor API_Consumer 

== Creating the trip collection & getting the initial set of trips ==
API_Consumer -> OSDM_Provider: POST /Trips-offers-collection <MUNCHEN-PARIS, 23/10/2021, 2 pax, dob, ...>
OSDM_Provider -> Journey_Planner : <retrieve trips information based on API Consumer request>
Journey_Planner - -> OSDM_Provider : <trips information>
loop for each trip    
    loop for each segment
        OSDM_Provider -> OSDM_Provider: determine FareProvider
    end
end
OSDM_Provider -> OSDM_Provider : create offer requests
OSDM_Provider -> FareProvider1: get offers 
FareProvider1 -> FareProvider1: calculate offers
FareProvider1 - -> OSDM_Provider : request with trips
OSDM_Provider -> FareProvider2: get offers 
FareProvider2 -> FareProvider2: calculate offers
FareProvider2 - -> OSDM_Provider : request with trips
OSDM_Provider -> OSDM_Provider : reconcile trips and \nconstruct global offers
OSDM_Provider - -> API_Consumer: <Trips-offers-Collection with list of references to tripOffers and scrolling tokens>

== Retrieving an offer & setting seat selection options, starting with tripoffer overview==
API_Consumer -> OSDM_Provider: GET /Trips-offers/5678?embed="TRIPOFFERS.OFFERS, TRIPOFFERS.PASSENGERS "
OSDM_Provider - -> API_Consumer: <Trip-offer 5678 with its offers and passengers>
API_Consumer -> OSDM_Provider: GET /offers/8765?embed="OFFERS.OFFERPARTS"
OSDM_Provider - -> API_Consumer: <offer 8765 with its offerparts>
API_Consumer -> OSDM_Provider: PATCH /Offers/8765/reservations/7654/ \n<reservation with selectedPlaces or selectedOptions set with desired seating option>
OSDM_Provider - -> API_Consumer: <updated reservation 7654 with desired reservation options>

== setting additional passenger information that may be required for provisional booking, starting from the tripoffer overview ==
API_Consumer -> API_Consumer: check offer RequestedInformation
API_Consumer -> OSDM_Provider: PATCH /Offers/8765/passengers/123 < additional information for passenger 123>
OSDM_Provider - -> API_Consumer: <passenger updated with the added information>

== Creating a booking based on one or more offer(s) ==
API_Consumer -> OSDM_Provider: POST /bookings/ <offerId= 8765>
OSDM_Provider -> OSDM_Provider : create local booking 5678
OSDM_Provider -> FareProvider1: provisionally book offerpart1 
FareProvider1 -> FareProvider1: create FareProvider booking
FareProvider1 - -> OSDM_Provider : OK response (can vary per FareProvider)
OSDM_Provider -> OSDM_Provider : add FareProvider booking to local booking
OSDM_Provider -> FareProvider2: provisionally book offerpart2 
FareProvider2 -> FareProvider2: create FareProvider booking
FareProvider2 - -> OSDM_Provider : OK response (can vary per FareProvider)
OSDM_Provider -> OSDM_Provider : add FareProvider booking to local booking
OSDM_Provider - -> API_Consumer: <Created Booking 5678 with references to Trips, booked offers, passengers>

== setting additional passenger information that may be required to confirm the booking, starting from the booking overview ==
API_Consumer -> OSDM_Provider: GET /Bookings/5678?embed="BOOKEDOFFERS,BOOKEDOFFERS.PASSENGERS"
OSDM_Provider - -> API_Consumer: <Booking with booked offers and passengers resources>
API_Consumer -> API_Consumer: check booking RequestedInformation
API_Consumer -> OSDM_Provider: PATCH /Bookings/5678/passengers/123/ < additional information for passenger>
OSDM_Provider -> FareProvider1: update passenger data 
FareProvider1 - -> OSDM_Provider : OK response (can vary per FareProvider)
OSDM_Provider -> FareProvider2: update passenger data 
FareProvider2 - -> OSDM_Provider : OK response (can vary per FareProvider)
OSDM_Provider -> OSDM_Provider : update local booking 5678
OSDM_Provider - -> API_Consumer: <passenger 123 updated with the added information>

== setting fulfillment type for the booking ==
OSDM_Provider - -> API_Consumer: <Booking with only references to embedded resources>
API_Consumer -> OSDM_Provider: PATCH /Bookings/5678 <setting the fulfillmentOptions>
OSDM_Provider - -> API_Consumer: <Booking resource with updated fulfillmentOptions>

== confirming booking & triggering fulfillment ==
API_Consumer -> OSDM_Provider: POST /Bookings/5678/Fulfillments
OSDM_Provider -> FareProvider1: confirm & fulfill booking 
FareProvider1 - -> OSDM_Provider : OK response (can vary per FareProvider)
OSDM_Provider -> FareProvider2: confirm & fulfill booking 
FareProvider2 - -> OSDM_Provider : OK response (can vary per FareProvider)
OSDM_Provider -> OSDM_Provider: update local statuses & create fulfillment resources
OSDM_Provider - -> API_Consumer: <Fulfillments created in the booking 5678>
@enduml

PlantUML version 1.2020.22(Sun Dec 06 10:36:27 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>