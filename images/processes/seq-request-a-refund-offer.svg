<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="404px" preserveAspectRatio="none" style="width:977px;height:404px;" version="1.1" viewBox="0 0 977 404" width="977px" zoomAndPan="magnify"><defs><filter height="300%" id="fk5uj0embkna9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fk5uj0embkna9)" height="163.4688" style="stroke:#000000;stroke-width:2.0;" width="405" x="555" y="187.8281"/><rect fill="#FFFFFF" filter="url(#fk5uj0embkna9)" height="132.3359" style="stroke:#000000;stroke-width:2.0;" width="324" x="565" y="211.9609"/><rect fill="#FFFFFF" height="56.9375" style="stroke:none;stroke-width:1.0;" width="324" x="565" y="287.3594"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="64" x2="64" y1="40.2969" y2="397.4297"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="637" x2="637" y1="40.2969" y2="397.4297"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="788" x2="788" y1="40.2969" y2="397.4297"/><rect fill="#FEFECE" filter="url(#fk5uj0embkna9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="114" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="12" y="24.9951">API_Consumer</text><rect fill="#FEFECE" filter="url(#fk5uj0embkna9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="120" x="575" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="582" y="24.9951">OSDM_Provider</text><rect fill="#FEFECE" filter="url(#fk5uj0embkna9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="100" x="736" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="743" y="24.9951">FareProvider</text><rect fill="#EEEEEE" filter="url(#fk5uj0embkna9)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="970" x="0" y="70.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="970" y1="70.8633" y2="70.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="970" y1="73.8633" y2="73.8633"/><rect fill="#EEEEEE" filter="url(#fk5uj0embkna9)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="191" x="389.5" y="60.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="172" x="395.5" y="76.3638">Creating a refund offer</text><polygon fill="#A80036" points="625,110.5625,635,114.5625,625,118.5625,629,114.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="64" x2="631" y1="114.5625" y2="114.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="71" y="109.4966">GET /Bookings/5678?embed="BOOKEDOFFERS, TRIPS, FULFILLMENTS"</text><polygon fill="#A80036" points="75,139.6953,65,143.6953,75,147.6953,71,143.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="69" x2="636" y1="143.6953" y2="143.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="401" x="81" y="138.6294">&lt;Booking with BookedOffers, Trips and Fulfillments resources&gt;</text><polygon fill="#A80036" points="625,168.8281,635,172.8281,625,176.8281,629,172.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="64" x2="631" y1="172.8281" y2="172.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="549" x="71" y="167.7622">POST /Bookings/5678/refundOffers &lt;tickets to be refunded,  optionally overrule code&gt;</text><path d="M555,187.8281 L632,187.8281 L632,194.8281 L622,204.8281 L555,204.8281 L555,187.8281 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="163.4688" style="stroke:#000000;stroke-width:2.0;" width="405" x="555" y="187.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="570" y="200.895">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="308" x="647" y="200.0386">[for each fulfillment in the refund offer request]</text><path d="M565,211.9609 L629,211.9609 L629,218.9609 L619,228.9609 L565,228.9609 L565,211.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="132.3359" style="stroke:#000000;stroke-width:2.0;" width="324" x="565" y="211.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="580" y="225.0278">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="240" x="644" y="224.1714">[FareProvider supports refund offers]</text><polygon fill="#A80036" points="776,246.2266,786,250.2266,776,254.2266,780,250.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="637" x2="782" y1="250.2266" y2="250.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="644" y="245.1606">request refund offer</text><polygon fill="#A80036" points="648,275.3594,638,279.3594,648,283.3594,644,279.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="642" x2="787" y1="279.3594" y2="279.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="654" y="274.2935">refund offer</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="565" x2="889" y1="288.3594" y2="288.3594"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="230" x="570" y="298.5698">[refund only supports direct refund]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="637" x2="679" y1="323.2969" y2="323.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="679" x2="679" y1="323.2969" y2="336.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="638" x2="679" y1="336.2969" y2="336.2969"/><polygon fill="#A80036" points="648,332.2969,638,336.2969,648,340.2969,644,336.2969" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="644" y="318.231">calculate refund offer</text><polygon fill="#A80036" points="75,375.4297,65,379.4297,75,383.4297,71,379.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="69" x2="636" y1="379.4297" y2="379.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="343" x="81" y="374.3638">&lt;RefundOffer for the provided tickets or passengers&gt;</text><!--MD5=[25e904f233fc30ac952525a834ef16d7]
@startuml
hide footbox
== Creating a refund offer ==
API_Consumer -> OSDM_Provider: GET /Bookings/5678?embed="BOOKEDOFFERS, TRIPS, FULFILLMENTS"
OSDM_Provider - -> API_Consumer: <Booking with BookedOffers, Trips and Fulfillments resources>
API_Consumer -> OSDM_Provider: POST /Bookings/5678/refundOffers <tickets to be refunded,  optionally overrule code>
loop for each fulfillment in the refund offer request
    alt FareProvider supports refund offers 
      OSDM_Provider -> FareProvider: request refund offer
	  FareProvider - -> OSDM_Provider : refund offer
    else refund only supports direct refund
      OSDM_Provider -> OSDM_Provider: calculate refund offer
    end
end
OSDM_Provider - -> API_Consumer: <RefundOffer for the provided tickets or passengers>
@enduml

PlantUML version 1.2020.22(Sun Dec 06 10:36:27 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>