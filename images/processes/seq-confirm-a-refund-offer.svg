<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="431px" preserveAspectRatio="none" style="width:992px;height:431px;" version="1.1" viewBox="0 0 992 431" width="992px" zoomAndPan="magnify"><defs><filter height="300%" id="f1k9aya3ykq70s" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1k9aya3ykq70s)" height="117.5313" style="stroke:#000000;stroke-width:2.0;" width="405" x="570" y="187.8281"/><rect fill="#FFFFFF" filter="url(#f1k9aya3ykq70s)" height="59.2656" style="stroke:#000000;stroke-width:2.0;" width="332" x="570" y="319.3594"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="64" x2="64" y1="40.2969" y2="424.7578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="642" x2="642" y1="40.2969" y2="424.7578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="841" x2="841" y1="40.2969" y2="424.7578"/><rect fill="#FEFECE" filter="url(#f1k9aya3ykq70s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="114" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="12" y="24.9951">API_Consumer</text><rect fill="#FEFECE" filter="url(#f1k9aya3ykq70s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="120" x="580" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="587" y="24.9951">OSDM_Provider</text><rect fill="#FEFECE" filter="url(#f1k9aya3ykq70s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="100" x="789" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="796" y="24.9951">FareProvider</text><rect fill="#EEEEEE" filter="url(#f1k9aya3ykq70s)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="985" x="0" y="70.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="985" y1="70.8633" y2="70.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="985" y1="73.8633" y2="73.8633"/><rect fill="#EEEEEE" filter="url(#f1k9aya3ykq70s)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="186" x="399.5" y="60.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="167" x="405.5" y="76.3638">Confirm a refund offer</text><polygon fill="#A80036" points="630,110.5625,640,114.5625,630,118.5625,634,114.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="64" x2="636" y1="114.5625" y2="114.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="554" x="71" y="109.4966">GET /Bookings/5678?embed="BOOKEDOFFERS, TRIPS,FULFILLMENTS, REFUNDOFFERS"</text><polygon fill="#A80036" points="75,139.6953,65,143.6953,75,147.6953,71,143.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="69" x2="641" y1="143.6953" y2="143.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="491" x="81" y="138.6294">&lt;Booking with BookedOffers, Trips,Fulfillments and Refund Offers resources&gt;</text><polygon fill="#A80036" points="630,168.8281,640,172.8281,630,176.8281,634,172.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="64" x2="636" y1="172.8281" y2="172.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="462" x="71" y="167.7622">PATCH /Bookings/5678/exchangeOffers/23 &lt;setting statuts to confirmed</text><path d="M570,187.8281 L647,187.8281 L647,194.8281 L637,204.8281 L570,204.8281 L570,187.8281 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:2.0;" width="405" x="570" y="187.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="585" y="200.895">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="308" x="662" y="200.0386">[for each fulfillment in the refund offer request]</text><polygon fill="#A80036" points="829,222.0938,839,226.0938,829,230.0938,833,226.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="642" x2="835" y1="226.0938" y2="226.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="649" y="221.0278">apply refund</text><polygon fill="#A80036" points="653,251.2266,643,255.2266,653,259.2266,649,255.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="647" x2="840" y1="255.2266" y2="255.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="659" y="250.1606">OK</text><line style="stroke:#A80036;stroke-width:1.0;" x1="642" x2="684" y1="284.3594" y2="284.3594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="684" x2="684" y1="284.3594" y2="297.3594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="643" x2="684" y1="297.3594" y2="297.3594"/><polygon fill="#A80036" points="653,293.3594,643,297.3594,653,301.3594,649,297.3594" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="649" y="279.2935">update local statuses</text><path d="M570,319.3594 L634,319.3594 L634,326.3594 L624,336.3594 L570,336.3594 L570,319.3594 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:2.0;" width="332" x="570" y="319.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="585" y="332.4263">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="248" x="649" y="331.5698">[all fulfillments cancelled or refunded]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="642" x2="684" y1="357.625" y2="357.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="684" x2="684" y1="357.625" y2="370.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="643" x2="684" y1="370.625" y2="370.625"/><polygon fill="#A80036" points="653,366.625,643,370.625,653,374.625,649,370.625" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="649" y="352.5591">update global booking status</text><polygon fill="#A80036" points="75,402.7578,65,406.7578,75,410.7578,71,406.7578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="69" x2="641" y1="406.7578" y2="406.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="81" y="401.6919">200 OK</text><!--MD5=[cda36e201670ce67fbd88af8a4e615e5]
@startuml
hide footbox
== Confirm a refund offer ==
API_Consumer -> OSDM_Provider: GET /Bookings/5678?embed="BOOKEDOFFERS, TRIPS,FULFILLMENTS, REFUNDOFFERS"
OSDM_Provider - -> API_Consumer: <Booking with BookedOffers, Trips,Fulfillments and Refund Offers resources>
API_Consumer -> OSDM_Provider: PATCH /Bookings/5678/exchangeOffers/23 <setting statuts to confirmed
loop for each fulfillment in the refund offer request
      OSDM_Provider -> FareProvider: apply refund
	  FareProvider - -> OSDM_Provider : OK
	  OSDM_Provider -> OSDM_Provider : update local statuses
end
alt all fulfillments cancelled or refunded
    OSDM_Provider -> OSDM_Provider : update global booking status
end
OSDM_Provider - -> API_Consumer: 200 OK
@enduml

PlantUML version 1.2020.22(Sun Dec 06 10:36:27 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>